# Agent Context & Rules

## Git Commit 規範

本文檔定義本專案的 Git Commit 訊息規範，AI Agent 在產生 Commit Message 時必須嚴格遵守。

### 1. Commit 結構 (Structure)

- 請遵循標準格式：

```text
<type>(<scope>): <subject>

<body>

<footer>

```

- **Type**: 變更類型 (必填)。
- **Scope**: 影響範圍 (選填)。
- **Subject**: 簡短描述 (必填)。
- **Body**: 詳細說明 (選填)。
- **Footer**: 額外資訊 (選填)。

### 2. Type (變更類型)

- 請嚴格使用以下定義的 Type，不得擅自創造新類型。

| Type | 說明 | 適用場景 |
| --- | --- | --- |
| `feat` | 新功能 | 新增功能 (feature)。 |
| `fix` | 錯誤修復 | 修復 bug。 |
| `docs` | 文檔 | 僅修改文件 (documentation)。 |
| `style` | 格式 | 不影響程式碼運行的變更 (空白、格式化、分號等)。 |
| `refactor` | 重構 | 既不是新增功能也不是修復 bug 的程式碼變更。 |
| `perf` | 效能 | 提升效能的程式碼變更。 |
| `test` | 測試 | 新增或修正測試案例。 |
| `build` | 建置與依賴 | 影響建置系統或外部依賴的變更 (如: npm, gulp, 依賴版本升級)。 |
| `ci` | CI 設定 | CI 設定檔與腳本的變更 (如: Travis, Circle, GitHub Actions)。 |
| `chore` | 雜項 | 其他不修改 src 或 test 檔案的變更 (如: .gitignore)。 |
| `revert` | 回退 | 回退先前的 commit。 |

### 3. Scope (影響範圍)

- Scope 用於說明變更的影響範圍。
- **推斷邏輯**：若變更檔案集中在特定模組或元件（如 `auth`, `header`, `api`），請填寫該名稱。
- **省略情況**：若影響範圍廣泛、屬於全域設定或無法具體界定，請省略 Scope。

### 4. Subject (摘要標題)

- Subject 是變更的「摘要標題」，不需刻意限制字數，重點在於「一目瞭然」與「完整性」。

#### 核心原則 (Core Principles)

- **資訊優先於簡短**：只要能清楚表達核心變更，不需強行縮減字數。
- **涵蓋主要項目**：若變更包含關鍵細節（如特定的驗證機制、演算法），應在 Subject 中提及。
- **高資訊密度**：避免使用空泛的詞彙（如 "修改程式碼"），應使用具體的業務或技術術語。

#### 撰寫規則 (Writing Rules)

- **語言**：使用 **繁體中文 (Traditional Chinese)**。
- **動詞開頭**：描述「做了什麼」。
- **結尾**：**嚴禁**使用句號 `。` (注意：此規則僅適用於 Commit Subject 本身，本文檔的清單項目仍需句號)。
- **多重點表達**：若同一個 Commit 包含兩個相關連的重要變更，可用空格或連接詞簡述（例如：「...並...」）。

#### 建議動詞 (Recommended Verbs)

- `feat`: 新增。
- `fix`: 修正。
- `docs`: 更新文檔。
- `style`: 調整格式。
- `refactor`: 重構。
- `perf`: 優化。
- `test`: 新增測試/修正測試。
- `build`: 更新建置/升級依賴。
- `chore`: 調整雜項。

### 5. Body (詳細說明)

#### 生成觸發條件 (Trigger)

- 符合以下任一情況時，**必須**撰寫 Body：
- **多檔案變更**：修改檔案數量 > 3 個。
- **大量修改**：總修改行數 > 50 行。
- **Breaking Changes**：任何破壞性更新。
- **邏輯複雜**：需要解釋動機 (Motivation) 或實作細節 (Implementation) 的變更。

#### 格式與內容規範

- **說明動機**：簡述為什麼需要這個變更，以及與原本行為的差異。
- **列表格式**：若需列點，請使用 `-` 開頭，並在句尾加上結尾符號。

### 6. Footer (額外資訊)

- Footer 用於描述與前版不相容的變更 (Breaking Changes)、棄用功能 (Deprecated) 或關聯 Issue。
- 格式規範：Footer 區塊應與 Body 之間保留**一行空行**。

#### Breaking Changes (破壞性更新)

- 當變更會導致舊版程式碼無法運作時使用。
- **關鍵字**：以 `BREAKING CHANGE` 開頭。
- **格式**：關鍵字後**必須使用兩個換行符**（即換行並保留一行空行），然後詳細說明變更內容與遷移指南。

#### Deprecated (功能棄用)

- 當某個功能或 API 被宣告過時（即將在未來版本移除）時使用。
- **關鍵字**：以 `DEPRECATED` 開頭。
- **格式**：關鍵字後**必須使用兩個換行符**，然後說明棄用原因與替代方案。

#### 關聯 Issue

- 若變更解決了特定 Issue，請在最後一行標註。
- 範例：`Closes #123`, `Fixes #201`。

### 7. 禁止事項 (AI Constraints)

- 為了保持 Commit Log 的乾淨與專業，生成訊息時**嚴格禁止**包含以下內容：
- ❌ **AI 相關聲明**：如 "Generated by Claude Code", "AI assisted"。
- ❌ **編輯器資訊**：如 "Code edited in VSCode", "Formatted by Prettier"。
- ❌ **無意義的統計數據**：如 "Tests passed: 15/15", "Coverage: 100%" (除非是 `perf` 類型的具體效能數據)。
- ❌ **過度冗長的廢話**：請直接切入變更重點，不需要 "Here is the commit message..." 等開場白。

### 8. 參考範例 (Examples)

#### 範例 A：簡單修復

```text
fix(ui): 修正行動版分頁按鈕錯位問題

調整 flex-direction 屬性，確保上一頁、頁碼與下一頁按鈕在行動裝置上水平排列。
```

#### 範例 B：複雜功能 (Breaking Change)

```text
feat(auth): 重構登入機制並依循 OAuth 2.0 標準

- 改用 JWT 取代傳統 Session 驗證。
- 更新 API 回傳格式，現在會包含 `expires_in` 欄位。
- 移除舊版 `login_check` 路由。

BREAKING CHANGE:
舊版 /api/login 接口已移除，請改用 /api/v2/auth/token。
且請求 header 需強制加上 `Content-Type: application/json`。

Closes #142
```
